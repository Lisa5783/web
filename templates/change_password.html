{% extends "base.html" %}
{% block title %}Смена пароля{% endblock %}

{% block content %}
<div class="container mt-5" style="max-width: 500px;">
    <h1 class="mb-4 text-center">Смена пароля</h1>
    <form method="post">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        
        <!-- Старый пароль -->
        <div class="mb-3">
            <label for="old_password" class="form-label">Текущий пароль</label>
            <input type="password" name="old_password" id="old_password" 
                   class="form-control {% if 'Неверный текущий пароль' in get_flashed_messages(category_filter=['danger']) %}is-invalid{% endif %}" 
                   required>
        </div>

        <!-- Новый пароль -->
        <div class="mb-3">
            <label for="new_password" class="form-label">Новый пароль</label>
            <input type="password" name="new_password" id="new_password" 
                   class="form-control {% if 'Новые пароли не совпадают' in get_flashed_messages() or 'Длина пароля' in get_flashed_messages() %}is-invalid{% endif %}" 
                   required>
        </div>

        <!-- Подтверждение пароля -->
        <div class="mb-3">
            <label for="confirm_password" class="form-label">Повторите новый пароль</label>
            <input type="password" name="confirm_password" id="confirm_password" 
                   class="form-control {% if 'Новые пароли не совпадают' in get_flashed_messages() %}is-invalid{% endif %}" 
                   required>
        </div>

        <!-- Вывод ошибок -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} mt-2">{{ message }}</div>
            {% endfor %}
        {% endwith %}

        <button type="submit" class="btn btn-primary w-100">Изменить пароль</button>
    </form>
</div>
{% endblock %}
